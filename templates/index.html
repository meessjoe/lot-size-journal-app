{% extends "layout.html" %}
{% block content %}

<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Calculator Section -->
    <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">Lot Size Calculator</h2>
        <form action="/calculate" method="POST" class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
                <input name="entry_price" type="number" step="any" value="{{ request.form.get('entry_price', '') }}" placeholder="Entry Price" class="input">
                <input name="stop_loss" type="number" step="any" value="{{ request.form.get('stop_loss', '') }}" placeholder="Stop Loss" class="input">
                <input name="take_profit" type="number" step="any" value="{{ request.form.get('take_profit', '') }}" placeholder="Take Profit" class="input">
                <input name="risk_amount" type="number" step="any" value="{{ request.form.get('risk_amount', '') }}" placeholder="Risk Amount" class="input">
            </div>
            <div class="flex space-x-4">
                <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Calculate</button>
                {% if lot_size %}
                <form action="/save" method="POST">
                    {% for field in ['entry_price', 'stop_loss', 'take_profit', 'risk_amount'] %}
                        <input type="hidden" name="{{ field }}" value="{{ request.form.get(field) }}">
                    {% endfor %}
                    <input type="hidden" name="lot_size" value="{{ lot_size }}">
                    <input type="hidden" name="expected_profit" value="{{ expected_profit }}">
                    <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded">Save to Journal</button>
                </form>
                {% endif %}
            </div>
            {% if lot_size %}
            <div class="mt-4 bg-gray-100 p-4 rounded">
                <p><strong>Lot Size:</strong> {{ lot_size }}</p>
                <p><strong>Expected Profit:</strong> {{ expected_profit }}</p>
            </div>
            {% endif %}
        </form>
    </div>

    <!-- Journal Section -->
    <div>
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold">Trade Journal</h2>
            <div>
                <a href="{{ url_for('index') }}" class="text-sm text-blue-500 hover:underline mr-2">All</a>
                <a href="{{ url_for('index', filter='complete') }}" class="text-sm text-green-500 hover:underline mr-2">Complete</a>
                <a href="{{ url_for('index', filter='incomplete') }}" class="text-sm text-yellow-500 hover:underline">Incomplete</a>
            </div>
        </div>
        {% if journal %}
        <div class="space-y-4">
            {% for entry in journal %}
            <div class="bg-white p-4 rounded shadow">
                <p><strong>Date:</strong> {{ entry.date }}</p>
                <p><strong>Entry:</strong> {{ entry.entry_price }}</p>
                <p><strong>SL:</strong> {{ entry.stop_loss }}</p>
                <p><strong>TP:</strong> {{ entry.take_profit }}</p>
                <p><strong>Risk:</strong> {{ entry.risk_amount }}</p>
                <p><strong>Lot:</strong> {{ entry.lot_size }}</p>
                <p><strong>Profit:</strong> {{ entry.expected_profit }}</p>
                {% if entry.result %}
                <p><strong>Result:</strong> {{ entry.result }}</p>
                {% endif %}
                {% if entry.observation %}
                <p><strong>Observation:</strong> {{ entry.observation }}</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p class="text-gray-500">No journal entries yet.</p>
        {% endif %}
    </div>
</div>

<style>
    .input {
        padding: 0.5rem;
        border: 1px solid #ccc;
        border-radius: 0.375rem;
        width: 100%;
    }
</style>

{% endblock %}
